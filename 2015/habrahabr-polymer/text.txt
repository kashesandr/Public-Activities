Вебкомпоненты -> Polymer 1.0 -> Пример

# Введение

## Кто я
Я - Александр Кашеверов, веб-разработчик, работаю в компании DataArt с 2011 года.

## О чём статья
Статья про веб-комоненты и Polymer с примером в конце.

## Вступление
Технологии для веба были внедрены исходя из потребностей, актуальных на момент создания. 10 лет назад невозможно было создать то, что мы создаём сейчас. Веб постоянно развивается, исходя из потребностей.
Сейчас бизнес требует создания крупных программных веб-продуктов с широкой функциональностью, красотой, высокой производительностью. И бизнес готов вкладывать в это деньги. Но реализация порой упирается в сложность и специфичность Веба. Сложный продукт вообще лучше сложным не делать, а разбить на более простые и изолированные части и вложиться в структуру. Подобный компонентный подход позволяет вести разработку частей продукта независимо от других частей и повторно использовать уже готовые. Для больших команд это важно. Разработка одних компонентов должна быть максимально независима от разработки других компонентов. Для нас в контексте веба при разработке отдельного компонента необходимо чтобы:
 1. CSS не пересекался,
 2. Области видимости JS не пересекались.
 3. HTML не имел излиших бессмысленных элементов в DOM-дереве и был хорошо читаемым. Так же желательно не упираться в ограничения и иметь возможность создавать свои теги, к тому же теги должны быть совместими со стилями и JS.

# Web Components

Веб медленно, но верно, движется к компонентизации - это естесственный процесс. Всё сложное можно упростить, разбив на более простые части. Фреймворки в той или иной степени внедряют компонентизацию. Angular, к примеру, даёт возможность создавать директивы с изолированной логикой и их достаточно просто переиспользовать. Даже CSS можно псевдоинкапсулировать (https://github.com/Yappli/angular-css-injector). Последнее время набирают популярность веб компоненты. Это реализация идеи компонентизации на уровне браузера.
Веб компоненты начали свою историю в 2012 году. Если коротко, они состоят и 4 основных частей:
- Custom Elements (создание своих html элементов, дополнение существующих)
- Shadow DOM (инкапсуляция логики и стилей)
- Templates (создание шаблнов)
- HTML imports (вместо отдельного подключения разных типов файлов [css, js, ..] - можно подключать HTML компонент, который сам изолированно все подтягивает в документ)
Соединяя эти 4 технологии вместе получаются автономные пеереиспользуемые блоки.
Простейший пример веб-компонента - <select>. Для него есть отдельных тег. Кликая на элемент появляется выпадающий список и его логика скрыта от нас. В этом и есть суть вебкомпонентов - мы создаем простые и понятные элементы со скрытой логикой, стилями.
?тут пример как выглядят вебкомпоненты в бою
Наверняка, многие подключали в проект Bootstrap - для этого нужно отдельно прописать подгрузку стилей и скриптов. С компонентами это можно сделать проще: [code]<link rel="import" href="bootstrap.html"></link>[/code]
И наконец-то можно будет подключать google analytics без лишнего кода, например так: [code]<google-analytics domain="example.com" code="UA-XXXXX-Y"></google-analytics>[/code]
Web components - это не фреймворк. Это набор технологий, реализованных на уровне браузера.

## web components - поддержка браузерами
На данный момент 3 из 4 технологий находятся в стадии "Working Draft" на W3C.
И, конечно, технологии не поддерживаются всеми браузерами.
Текущее состояние дел: http://caniuse.com/#search=components, http://jonrimmer.github.io/are-we-componentized-yet/
Так как веб компоненты в перспективе имеют высоую ценность для разработчиков, но еще не поддерживаются всеми браузерами, то создаются способы, чтобы технология-таки работала везде. Так родился проект https://github.com/webcomponents/webcomponentsjs#browser-support. Используя его, поддержка бреузерами уже получше

## web components - полезные ссылки
Что почитать еще:
https://learn.javascript.ru/webcomponentsъ
?еще ссылок

# Polymer

Тем временем Google решил всё упрощать и развивать. Судя по истории коммитов на github, работа началась осенью 2012 года. Они взяли веб компоненты, полифилы и создали еще одну надстройку над всем этим.
Цель Polymer (со слов product manager'а) - упростить создание качественных веб-приложений.

## Polymer - коротко что это
Полимер из себя представляет те же вебкомпоненты в основе (shadow dom, custom elements, html imports, templates), полифилы для поддержки неподдерживающих браузеров, все обернуто в целостную более удобную экосистему. А на основе этого Google создал набор примеров переиспользуемых компонентов. Разбили их на части:
 - Iron elements (основные строительные блоки)
 - Paper elements (готовые переиспользуемые элементы на основе iron-elements и material design)
 - Google web components (коллекция веб компонентов, использующих различные API Google. Например: maps, youtube, drive)
 - Gold elements (элементы специфичные для интернет-коммерции, например input-element для валидации кредитной карты)
 - Neon elements (элементы для создания анимаций)
 - Platinum elements (элементы помогабщие создать из веб-страницы настоящее веб приложение, например push-нотификации, использование offline версии, bluetooth)
 - Molecules (элементы-обёртки других библиотек/приложений, для более простого использования)
На конференции Google IO 2015 в мае 2015 анонсировали версию 1.0.
Когда вы создаёте приложение у вас есть полный список строительных блоков. С какой проблемой бы вы не столкнулись - для её решения есть элемент. "there is an element for that" - звучит как слоган в докладах Google IO 2015.
Философия в том что всё - это элементы. Даже ajax запрос.
?пример запроса
?elements.polymer.com - каталог. "there is an element for that"

Polymer - это не фреймворк. Это обёртка и сахар. Я бы сравнил его с библиотекой jQuery. Но jQuery создана для работы с DOM, а Polymer для работы с web components.

## Polymer - тестируемость
Да, он тестируемый и для этого создана отдельная утилита https://github.com/Polymer/web-component-tester

## Polymer - примеры работ
https://translate.google.com/
https://play.google.com/music/listen#/sulp
http://todomvc.com/examples/polymer/index.html
https://santatracker.google.com/

Anonymous chat http://pubnub.github.io/paper-chat/ + src
home assistant https://home-assistant.io/demo/ + src

## Polymer - поддержка браузерами
У меня так и не получилось запустить на старом андроид-телефоне

## Polymer - производительность
Polymer.js performance on mobile platforms can often be somewhere between frustrating and problematic.

## Polymer - vulcanize
HTML imports feature -> into a single file

## Polymer - starter kit
???

## Polymer - альтернативы
http://bosonic.github.io/
http://x-tags.org/

## Polymer - почитать
https://www.youtube.com/watch?v=fD2As5RmM8Q

# Пример

# Выводы

# Если есть ошибки - пишите личным сообщением. Спасибо!

# от себя
сначала была идея, потом решил что хочу полимер, но мотиватором стало выступление на летней практике, я пообещал, что выступлю
при изучении новой технологии мне проще не пользоваться boilerplate, а сначала узнать азы

http://www.pubnub.com/blog/creating-a-polymer-chat-app-with-material-design/

chip-in.me github.com/kashesandr/CIC

Пример без Polymer
<template id="template">
  <style>input { color: orange; }</style>
  <input type="text">
</template>
<script>
var proto = Object.create(HTMLElement.prototype, {
  createdCallback: {
    value: function() {
      var t = document.querySelector('#template');
      this.createShadowRoot().appendChild(t.content.cloneNode(true));
    }
  }
});
var MyInput = document.register('my-input', {prototype: proto});
</script>

Пример с Polymer
<polymer-element name="my-input" constructor="MyInput" noscript>
  <!-- Note: Polymer creates Shadow DOM from the first <template>. -->
  <template>
    <style>input { color: orange; }</style>
    <input type="text">
  </template>
</polymer-element>

<my-input></my-input>
// var myInput = document.createElement('my-input');
// var myInput = new MyInput();